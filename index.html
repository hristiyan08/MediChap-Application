<!DOCTYPE html>
<html lang="bg">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>MediChat Application</title>
    <link rel="stylesheet" href="style.css">
</head>
<body>
<img src="images/MediChat_transparent-.png" height="400" width="400" class="logo-image" alt="MediChat Logo" />
<h1 class="title">Портал за кандидатстване на лекари към MediChat</h1>
<form id="application-form">
    <p class="title-text">Моля, попълнете Вашите данни, за да кандидатстване за достъп към MediChat:</p>
    <input type="text" id="name" class="name" placeholder="Имена" required><br>
    <input type="text" id="uin" class="uin" placeholder="УИН" required><br>
    <input type="email" id="email" class="email" placeholder="Имейл" required><br>
    <input type="submit" class="apply-button" value="Кандидатствай!" id="apply">
</form>
<script type="module">
    import { getAuth, createUserWithEmailAndPassword, sendPasswordResetEmail } from "https://www.gstatic.com/firebasejs/10.14.1/firebase-auth.js";
    import { initializeApp } from "https://www.gstatic.com/firebasejs/10.14.1/firebase-app.js";

    const firebaseConfig = {
        apiKey: "AIzaSyDiiAFQ8wsOQDPhNtpz-5OK6vRRaZScBwc",
        authDomain: "medichat-c9b01.firebaseapp.com",
        databaseURL: "https://medichat-c9b01-default-rtdb.europe-west1.firebasedatabase.app",
        projectId: "medichat-c9b01",
        storageBucket: "medichat-c9b01.appspot.com",
        messagingSenderId: "444288721707",
        appId: "1:444288721707:web:c20c844c3e07406ae95b6e",
        measurementId: "G-8Y04QRWSVD"
    };

    const app = initializeApp(firebaseConfig);
    const auth = getAuth();

    document.getElementById("application-form").addEventListener("submit", function(event) {
        event.preventDefault(); // Prevent default form submission

        const email = document.getElementById("email").value;

        // Register the user
        const password = prompt("Please set a password for your account:"); // Prompt for password
        createUserWithEmailAndPassword(auth, email, password)
            .then(() => {
                alert("Registration successful! You will receive a confirmation email.");
                // Send password reset email immediately after registration
                sendPasswordResetEmail(auth, email)
                    .then(() => {
                        alert("Open your email for instructions to reset your password.");
                    })
                    .catch((error) => {
                        const errorMessage = error.message;
                        alert(`Error sending password reset email: ${errorMessage}`);
                    });
            })
            .catch((error) => {
                const errorMessage = error.message;
                alert(`Error during registration: ${errorMessage}`);
            });
    });
</script>
</body>
</html>
